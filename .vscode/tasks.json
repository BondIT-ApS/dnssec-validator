{
  "version": "2.0.0",
  "tasks": [
    // ========================================
    // ğŸ Backend Tasks
    // ========================================
    {
      "label": "ğŸ§± Setup Virtual Environment",
      "type": "shell",
      "command": "python3 -m venv .venv && source .venv/bin/activate && pip install --upgrade pip && pip install -r requirements.txt",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸš€ Run Flask Development Server",
      "type": "shell",
      "command": "source .venv/bin/activate && python app/app.py",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "group": {
        "kind": "build",
        "isDefault": false
      }
    },
    {
      "label": "ğŸ§ª Run Tests with Coverage",
      "type": "shell",
      "command": "source .venv/bin/activate && python -m pytest tests/ --cov=app --cov-report=html --cov-report=term -o addopts=\"\"",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      },
      "group": {
        "kind": "test",
        "isDefault": true
      }
    },
    {
      "label": "ğŸ¨ Format with Black",
      "type": "shell",
      "command": "black app/ tests/ --line-length=88 --exclude='.git,.github,data'",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ Lint with Pylint",
      "type": "shell",
      "command": "source .venv/bin/activate && pylint app/*.py --rcfile=.pylintrc",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ›¡ï¸ Security: Bandit Scan",
      "type": "shell",
      "command": "source .venv/bin/activate && bandit -r app/ -f json -o bandit-report.json --exit-zero || true",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ”’ Security: Safety CLI Scan",
      "type": "shell",
      "command": "SAFETY_STAGE=production safety scan --detailed-output || true",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new",
        "showReuseMessage": false
      }
    },

    // ========================================
    // ğŸ³ Docker Tasks
    // ========================================
    {
      "label": "ğŸ³ Docker: Build and Run",
      "type": "shell",
      "command": "docker-compose up -d --build",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ³ Docker: Stop Services",
      "type": "shell",
      "command": "docker-compose down",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ³ Docker: View Logs",
      "type": "shell",
      "command": "docker-compose logs -f",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ³ Docker: Restart Services",
      "type": "shell",
      "command": "docker-compose restart",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ©º Docker: Health Check",
      "type": "shell",
      "command": "curl -f http://localhost:8080/health || echo 'Health check failed'",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },

    // ========================================
    // ğŸ”§ Development Tasks
    // ========================================
    {
      "label": "ğŸ“¦ Update Dependencies",
      "type": "shell",
      "command": "source .venv/bin/activate && pip install --upgrade pip && pip install -r requirements.txt",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },
    {
      "label": "ğŸ§¹ Clean Cache",
      "type": "shell",
      "command": "find . -type d -name '__pycache__' -exec rm -rf {} + 2>/dev/null || true && find . -type f -name '*.pyc' -delete && rm -rf .pytest_cache htmlcov .coverage",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },

    // ========================================
    // ğŸ”§ GitHub Actions Tasks
    // ========================================
    {
      "label": "ğŸ”§ Lint GitHub Actions Workflows",
      "type": "shell",
      "command": "SHELLCHECK_OPTS=\"-e SC2129\" actionlint .github/workflows/*.yml",
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "new"
      }
    },

    // ========================================
    // ğŸ§± Quality Gate Tasks
    // ========================================
    {
      "label": "ğŸ§± Backend Quality Check",
      "dependsOn": [
        "ğŸ¨ Format with Black",
        "ğŸ Lint with Pylint",
        "ğŸ›¡ï¸ Security: Bandit Scan",
        "ğŸ”’ Security: Safety CLI Scan"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": []
    },
    {
      "label": "ğŸ§± Full Quality Check",
      "dependsOn": [
        "ğŸ§± Backend Quality Check",
        "ğŸ”§ Lint GitHub Actions Workflows"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": []
    },
    {
      "label": "ğŸš€ Pre-Push Quality Gate",
      "dependsOn": [
        "ğŸ¨ Format with Black",
        "ğŸ Lint with Pylint",
        "ğŸ§ª Run Tests with Coverage",
        "ğŸ›¡ï¸ Security: Bandit Scan",
        "ğŸ”’ Security: Safety CLI Scan",
        "ğŸ³ Docker: Build and Run",
        "ğŸ©º Docker: Health Check"
      ],
      "dependsOrder": "sequence",
      "problemMatcher": [],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    }
  ]
}
